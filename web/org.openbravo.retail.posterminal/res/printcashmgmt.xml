<?xml version="1.0" encoding="UTF-8"?>

<output>
  <ticket>
  <%
    var total = OB.DEC.Zero;
    %>
    <line>
        <image>logofb.png</image>
    </line>
    <line></line>
    <line>
      <text align="center" length="42"><%= OB.UTIL.encodeXMLComponent(OB.I18N.getLabel('OBPOS_LblCashMgmtHeader')) %></text>
    </line>
    <line>
    </line>
    <line>
      <text align="left" length="42"><%= OB.UTIL.encodeXMLComponent(OB.I18N.getLabel('OBPOS_LblUser')+': '+OB.POS.modelterminal.get('context').user._identifier) %></text>
    </line>
    <line>
      <text align="left" length="42"><%= OB.UTIL.encodeXMLComponent(OB.I18N.getLabel('OBPOS_LblTime')+': '+ new Date().toString().substring(3,24)) %></text>
    </line>
    <line>
      <text align="left" length="42"><%= OB.UTIL.encodeXMLComponent(OB.I18N.getLabel('OBPOS_LblStore')+': '+ OB.POS.modelterminal.get('terminal').organization$_identifier) %></text>
    </line>
    <line>
      <text align="left" length="42"><%= OB.UTIL.encodeXMLComponent(OB.I18N.getLabel('OBPOS_LblTerminal')+': '+ OB.POS.modelterminal.get('terminal')._identifier) %></text>
    </line>
    <line>
    </line>
    <%
    cashmgmt.forEach(function(depositsdrops){
    if(depositsdrops.type==='drop'){
    %>
    <line>
      <text align ="left" length="12"><%=OB.UTIL.encodeXMLComponent(depositsdrops.description) %></text>
      <text align ="left" length="1"><%=' '%></text>
      <text align ="left" length="10"><%=OB.UTIL.encodeXMLComponent(depositsdrops.user) %></text>
      <text align ="left" length="1"><%=' '%></text>
      <text align ="left" length="8"><%=OB.UTIL.encodeXMLComponent(depositsdrops.time) %></text>
      <text align ="right" length="7"><%= OB.I18N.formatCurrency(OB.DEC.sub(0,depositsdrops.amount)) %></text>
    </line>
    <%
    total = OB.DEC.sub(total, depositsdrops.amount);
    }else{
    %>
     <line>
      <text align ="left" length="12"><%=OB.UTIL.encodeXMLComponent(depositsdrops.description) %></text>
      <text align ="left" length="1"><%=' '%></text>
      <text align ="left" length="10"><%=OB.UTIL.encodeXMLComponent(depositsdrops.user) %></text>
      <text align ="left" length="1"><%=' '%></text>
      <text align ="left" length="8"><%=OB.UTIL.encodeXMLComponent(depositsdrops.time) %></text>
      <text align ="right" length="7"><%= OB.I18N.formatCurrency(OB.DEC.add(0,depositsdrops.amount)) %></text>
    </line>
    <%
    total = OB.DEC.add(total, depositsdrops.amount);
    }
    });
    %>
     <line>
      <text align ="left" length="25" bold="true"><%=OB.UTIL.encodeXMLComponent(OB.I18N.getLabel('OBPOS_LblTotal')) %></text>
      <text align ="right" length="14" bold="true"><%= OB.I18N.formatCurrency(OB.DEC.add(0,total)) %></text>
    </line>
  </ticket>
</output>