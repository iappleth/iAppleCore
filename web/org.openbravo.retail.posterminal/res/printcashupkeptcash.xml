<?xml version="1.0" encoding="UTF-8"?>
<!--
 ************************************************************************************
 * Copyright (C) 2022 Openbravo S.L.U.
 * Licensed under the Openbravo Commercial License version 1.0
 * You may obtain a copy of the License at http://www.openbravo.com/legal/obcl.html
 * or in the legal folder of this module distribution.
 ************************************************************************************
-->

<output>
    <ticket>
        <line>
            <image>ticket-image.png</image>
        </line>
        <line>
            <text align="center" length="42"><%=
                OB.UTIL.encodeXMLComponent(OB.I18N.getLabel('OBPOS_CashUpKeptCash_Title')) %>
            </text>
        </line>
        <line>
        </line>
        <line>
            <text align="center" length="42"><%= OB.UTIL.encodeXMLComponent(OB.I18N.getLabel('OBPOS_LblStore') + ': ' +
                OB.POS.modelterminal.get('terminal').organization$_identifier) %>
            </text>
        </line>
        <line>
            <text align="center" length="42"><%= OB.UTIL.encodeXMLComponent(OB.I18N.getLabel('OBPOS_LblTerminal') + ': '
                + OB.POS.modelterminal.get('terminal')._identifier) %>
            </text>
        </line>
        <line>
            <text align="center" length="42"><%= OB.UTIL.encodeXMLComponent(OB.I18N.getLabel('OBPOS_LblUser') + ': ' +
                OB.POS.modelterminal.get('context').user._identifier) %>
            </text>
        </line>
        <line>
            <text align="center" length="42"><%= OB.UTIL.encodeXMLComponent(OB.I18N.getLabel('OBPOS_LblTime') + ': ' +
                OB.I18N.formatDate(cashup.report.get('time')) + ' - ' + OB.I18N.formatHour(cashup.report.get('time')))
                %>
            </text>
        </line>
        <line>
        </line>
        <%
        _.each(cashup.summary.qtyToKeepSummary, function(payment) {
        if(printablePaymentMethods.includes(payment.get('searchKey'))) {
        const paymentMethodName = currentSafeBoxName && safeBoxPaymentMethods.includes(payment.get('searchKey')) ?
        OB.I18N.getLabel('OBPOS_PaymentMethodOnSafebox', [payment.get('name'), currentSafeBoxName]) :
        payment.get('name');
        if (payment.get('second') && payment.get('second') !== payment.get('value')) {
        %>
        <line>
            <text align="left" length="18"><%= OB.UTIL.encodeXMLComponent(paymentMethodName) %>
            </text>
            <text align="right" length="11"><%= '(' + OB.I18N.formatCurrency(payment.get('second')) + ' ' +
                payment.get('isocode') + ')' %>
            </text>
            <text align="right" length="10"><%= OB.I18N.formatCurrency(payment.get('value')) %>
            </text>
        </line>
        <%
        }else{
        %>
        <line>
            <text align="left" length="25"><%= OB.UTIL.encodeXMLComponent(paymentMethodName) %>
            </text>
            <text align="right" length="14"><%= OB.I18N.formatCurrency(payment.get('value')) %>
            </text>
        </line>
        <%
        }
        }
        });
        %>
        <line>
            <text align="left" length="25" bold="true"><%=
                OB.UTIL.encodeXMLComponent(OB.I18N.getLabel('OBPOS_LblTotalQtyToKeep')) %>
            </text>
            <text align="right" length="14" bold="true"><%= OB.I18N.formatCurrency(cashup.summary.totalQtyToKeep) %>
            </text>
        </line>
        <line>
        </line>
    </ticket>
</output>