<?xml version="1.0" encoding="UTF-8"?>
<!--
 ************************************************************************************
 * Copyright (C) 2012 Openbravo S.L.U.
 * Licensed under the Openbravo Commercial License version 1.0
 * You may obtain a copy of the License at http://www.openbravo.com/legal/obcl.html
 * or in the legal folder of this module distribution.
 ************************************************************************************
-->

<output>
  <ticket>
  <%
    var dropsAmount = OB.DEC.Zero, depositsAmount = OB.DEC.Zero;
   %>
    <line>
        <image>ticket-image.png</image>
    </line>
    <line></line>
    <line>
      <text align="center" length="42"><%= OB.UTIL.encodeXMLComponent(OB.I18N.getLabel('OBPOS_LblUser')+': '+ OB.POS.modelterminal.get('context').user._identifier) %></text>
    </line>
    <line>
      <text align="center" length="42"><%= OB.UTIL.encodeXMLComponent(OB.I18N.getLabel('OBPOS_LblTime')+': '+ cashup.time) %></text>
    </line>
    <line>
    </line>
    <line>
      <text align ="left" length="25"><%=OB.UTIL.encodeXMLComponent(OB.I18N.getLabel('OBPOS_LblNetSales')) %></text>
      <text align ="right" length="14"><%= OB.I18N.formatCurrency(cashup.transactions.models[0].get('netSales')) %></text>
    </line>
    <%
    cashup.transactions.models[0].get('salesTaxes').forEach(function(tax){
    %>
    <line>
      <text align ="left" length="25"><%=OB.UTIL.encodeXMLComponent(tax.taxName+' * '+ OB.I18N.formatCurrency(cashup.transactions.models[0].get('netSales'))) %></text>
      <text align ="right" length="14"><%= OB.I18N.formatCurrency(tax.taxAmount) %></text>
    </line>
    <%
    });
    %>
    <line>
      <text align ="left" length="25" bold="true"><%=OB.UTIL.encodeXMLComponent(OB.I18N.getLabel('OBPOS_LblGrossSales')) %></text>
      <text align ="right" length="14" bold="true"><%= OB.I18N.formatCurrency(cashup.transactions.models[0].get('grossSales')) %></text>
    </line>
    <line>
    </line>
    <line>
      <text align ="left" length="25"><%=OB.UTIL.encodeXMLComponent(OB.I18N.getLabel('OBPOS_LblNetReturns')) %></text>
      <text align ="right" length="14"><%= OB.I18N.formatCurrency(cashup.transactions.models[0].get('netReturns')) %></text>
    </line>
    <%
    cashup.transactions.models[0].get('returnsTaxes').forEach(function(tax){
    %>
    <line>
      <text align ="left" length="25"><%=OB.UTIL.encodeXMLComponent(tax.taxName+' * '+ OB.I18N.formatCurrency(cashup.transactions.models[0].get('netReturns'))) %></text>
      <text align ="right" length="14"><%= OB.I18N.formatCurrency(tax.taxAmount) %></text>
    </line>
    <%
    });
    %>
    <line>
      <text align ="left" length="25" bold="true"><%=OB.UTIL.encodeXMLComponent(OB.I18N.getLabel('OBPOS_LblGrossReturns')) %></text>
      <text align ="right" length="14" bold="true"><%= OB.I18N.formatCurrency(cashup.transactions.models[0].get('grossReturns')) %></text>
    </line>
    <line>
    </line>
     <line>
      <text align ="left" length="25" bold="true"><%=OB.UTIL.encodeXMLComponent(OB.I18N.getLabel('OBPOS_LblTotalRetailTrans')) %></text>
      <text align ="right" length="14" bold="true"><%= OB.I18N.formatCurrency(cashup.transactions.models[0].get('totalRetailTransactions')) %></text>
    </line>
    <line>
    </line>
    <%
    cashup.transactions.models[0].get('drops').forEach(function(drop){
    dropsAmount = OB.DEC.add(dropsAmount,drop.amount);
    %>
    <line>
      <text align ="left" length="25"><%=OB.UTIL.encodeXMLComponent(OB.I18N.getLabel('OBPOS_LblWithdrawal')+': '+drop.description) %></text>
      <text align ="right" length="14"><%= OB.I18N.formatCurrency(drop.amount) %></text>
    </line>
    <%
    });
    %>
    <line>
      <text align ="left" length="25" bold="true"><%=OB.UTIL.encodeXMLComponent(OB.I18N.getLabel('OBPOS_LblTotalWithdrawals')) %></text>
      <text align ="right" length="14" bold="true"><%= OB.I18N.formatCurrency(dropsAmount) %></text>
    </line>
    <line>
    </line>
    <%
    cashup.transactions.models[0].get('deposits').forEach(function(deposit){
    depositsAmount = OB.DEC.add(depositsAmount,deposit.amount);
    %>
    <line>
      <text align ="left" length="25"><%=OB.UTIL.encodeXMLComponent(OB.I18N.getLabel('OBPOS_LblDeposit')+': '+deposit.description) %></text>
      <text align ="right" length="14"><%= OB.I18N.formatCurrency(deposit.amount) %></text>
    </line>
    <%
    });
    %>
    <line>
      <text align ="left" length="25" bold="true"><%=OB.UTIL.encodeXMLComponent(OB.I18N.getLabel('OBPOS_LblTotalDeposits')) %></text>
      <text align ="right" length="14" bold="true"><%= OB.I18N.formatCurrency(depositsAmount) %></text>
    </line>
    <line>
    </line>
    <%
    cashup.paymentmethods.forEach(function(payment){
    %>
    <line>
      <text align ="left" length="25"><%=OB.UTIL.encodeXMLComponent(payment.get('name')+' '+ OB.I18N.getLabel('OBPOS_LblExpected')) %></text>
      <text align ="right" length="14"><%= OB.I18N.formatCurrency(payment.get('expected')) %></text>
    </line>
    <%
    });
    %>
    <line>
      <text align ="left" length="25" bold="true"><%=OB.UTIL.encodeXMLComponent(OB.I18N.getLabel('OBPOS_LblTotalExpected')) %></text>
      <text align ="right" length="14" bold="true"><%= OB.I18N.formatCurrency(cashup.get('totalExpected')) %></text>
    </line>
    <line>
    </line>
    <%
    cashup.paymentmethods.forEach(function(payment){
    %>
    <line>
      <text align ="left" length="25"><%=OB.UTIL.encodeXMLComponent(payment.get('name')+' '+ OB.I18N.getLabel('OBPOS_LblCounted')) %></text>
      <text align ="right" length="14"><%= OB.I18N.formatCurrency(payment.get('counted')) %></text>
    </line>
    <%
    });
    %>
    <line>
      <text align ="left" length="25" bold="true"><%=OB.UTIL.encodeXMLComponent(OB.I18N.getLabel('OBPOS_LblTotalCounted')) %></text>
      <text align ="right" length="14" bold="true"><%= OB.I18N.formatCurrency(cashup.get('totalCounted')) %></text>
    </line>
    <line>
    </line>
    <%
    cashup.paymentmethods.forEach(function(payment){
    %>
    <line>
      <text align ="left" length="25"><%=OB.UTIL.encodeXMLComponent(payment.get('name')+' '+ OB.I18N.getLabel('OBPOS_LblDifference')) %></text>
      <text align ="right" length="14"><%= OB.I18N.formatCurrency(OB.DEC.sub(payment.get('counted'),payment.get('expected'))) %></text>
    </line>
    <%
    });
    %>
    <line>
      <text align ="left" length="25" bold="true"><%=OB.UTIL.encodeXMLComponent(OB.I18N.getLabel('OBPOS_LblTotalDifference')) %></text>
      <text align ="right" length="14" bold="true"><%= OB.I18N.formatCurrency(cashup.get('totalDifference')) %></text>
    </line>
    <line>
    </line>
  </ticket>
</output>